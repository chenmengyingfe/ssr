(function(t,i){if(typeof define==="function"&&define.amd){define([],i)}else if(typeof module==="object"&&module.exports){module.exports=i()}else{t.erudaFps=i()}})(this,function(){var t=window.innerWidth;return function(i){var e=t,s=192,a=12,n=8,l=12,h=40,r=t-24,f=142,o="#fff",c="#90caf9",_=2,u="FPS";var p=i.util,d=i.Settings,v=Math.round,m=i.Tool;var g=m.extend({name:"fps",init:function(t,i){this.callSuper(m,"init",arguments);this._style=p.evalCss([".eruda-fps {padding: 10px !important;}","canvas {width: 100%; border-radius: 4px; box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.05), 0 1px 4px 0 rgba(0, 0, 0, 0.08), 0 3px 1px -2px rgba(0, 0, 0, 0.2);}"].join(".eruda-fps "));this._container=i;this._isRunning=false;this._beginTime=p.now();this._prevTime=this._beginTime;this._frames=0;this._min=Infinity;this._max=0;this._alwaysActivated=true;this._appendTpl();this._initCanvas();this._initCfg()},show:function(){this._start();this.callSuper(m,"show",arguments)},hide:function(){if(!this._alwaysActivated)this._stop();this.callSuper(m,"hide",arguments)},destroy:function(){this._stop();p.evalCss.remove(this._style);this.callSuper(m,"destroy",arguments);this._rmCfg()},_rmCfg:function(){var t=this.config;var i=this._container.get("settings");if(!i)return;i.remove(t,"alwaysActivated").remove("Fps")},_start:function(){if(this._isRunning)return;var t=this;this._isRunning=true;function i(){if(!t._isRunning)return;t._update();requestAnimationFrame(i)}i()},_stop:function(){this._isRunning=false;this._beginTime=p.now();this._prevTime=this._beginTime;this._frames=0},_appendTpl:function(){this._$el.html("<canvas></canvas>");this._canvas=this._$el.find("canvas").get(0);this._ctx=this._canvas.getContext("2d")},_initCanvas:function(){var t=this._canvas,i=this._ctx;t.width=e;t.height=s;i.font="bold 18px Helvetica,Arial,sans-serif";i.textBaseline="top";i.fillStyle=o;i.fillRect(0,0,e,s);i.fillStyle=c;i.fillText(u,a,n);i.fillRect(l,h,r,f);i.fillStyle=o;i.globalAlpha=.9;i.fillRect(l,h,r,f)},_initCfg:function(){var t=this._container;var i=this.config=d.createCfg("fps",{alwaysActivated:true});if(!i.get("alwaysActivated"))this._alwaysActivated=false;var e=this;i.on("change",function(t,i){switch(t){case"alwaysActivated":e._alwaysActivated=i;return}});var s=t.get("settings");s.text("Fps").switch(i,"alwaysActivated","Always Activated").separator()},_update:function(){this._frames++;var t=this._prevTime,i=p.now();if(i>t+1e3){this._draw(this._frames*1e3/(i-t),100);this._prevTime=i;this._frames=0}this._beginTime=i},_draw:function(t,i){this._min=Math.min(this._min,t);this._max=Math.max(this._max,t);var s=this._min,p=this._max,d=this._canvas,m=this._ctx;m.fillStyle=o;m.globalAlpha=1;m.fillRect(0,0,e,h);m.fillStyle=c;m.fillText(v(t)+""+u+" ("+v(s)+"-"+v(p)+")",a,n);m.drawImage(d,l+_,h,r-_,f,l,h,r-_,f);m.fillRect(l+r-_,h,_,f);m.fillStyle=o;m.globalAlpha=.9;m.fillRect(l+r-_,h,_,v((1-t/i)*f))}});return new g}});